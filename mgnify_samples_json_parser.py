#!/usr/bin/env python3

import json

biosample_list = ["MGYS00000492","MGYS00000524","MGYS00000570","MGYS00000646","MGYS00000654","MGYS00000688","MGYS00000727","MGYS00000737","MGYS00000785","MGYS00000850","MGYS00000856","MGYS00000983","MGYS00000987","MGYS00001031","MGYS00001070","MGYS00001075","MGYS00001186","MGYS00001288","MGYS00001295","MGYS00001347","MGYS00001356","MGYS00001371","MGYS00001376","MGYS00001499","MGYS00001559","MGYS00001720","MGYS00001730","MGYS00001742","MGYS00001769","MGYS00001811","MGYS00001864","MGYS00001869","MGYS00001922","MGYS00001955","MGYS00001982","MGYS00001983","MGYS00001984","MGYS00001985","MGYS00001987","MGYS00001988","MGYS00001993","MGYS00002005","MGYS00002008","MGYS00002019","MGYS00002020","MGYS00002034","MGYS00002035","MGYS00002038","MGYS00002039","MGYS00002040","MGYS00002045","MGYS00002050","MGYS00002053","MGYS00002058","MGYS00002061","MGYS00002062","MGYS00002115","MGYS00002264","MGYS00002309","MGYS00002319","MGYS00002334","MGYS00002379","MGYS00002380","MGYS00002401","MGYS00002420","MGYS00002428","MGYS00002429","MGYS00002478","MGYS00002684","MGYS00002686","MGYS00002688","MGYS00002700","MGYS00002844","MGYS00002942","MGYS00003014","MGYS00003071","MGYS00003076","MGYS00003447","MGYS00003477","MGYS00003481","MGYS00003487","MGYS00003510","MGYS00003511","MGYS00003536","MGYS00003575","MGYS00003576","MGYS00003598","MGYS00003603","MGYS00003619","MGYS00003653","MGYS00004237","MGYS00004559","MGYS00004729","MGYS00005023","MGYS00005034","MGYS00005040","MGYS00005045","MGYS00005080","MGYS00005085","MGYS00005101","MGYS00005102","MGYS00005109","MGYS00005116","MGYS00005117","MGYS00005118","MGYS00005128","MGYS00005129","MGYS00005130","MGYS00005132","MGYS00005133","MGYS00005134","MGYS00005135","MGYS00005136","MGYS00005137","MGYS00005138","MGYS00005139","MGYS00005140","MGYS00005141","MGYS00005142","MGYS00005143","MGYS00005144","MGYS00005145","MGYS00005146","MGYS00005147","MGYS00005148","MGYS00005150","MGYS00005151","MGYS00005152","MGYS00005153","MGYS00005154","MGYS00005155","MGYS00005156","MGYS00005157","MGYS00005158","MGYS00005159","MGYS00005160","MGYS00005161","MGYS00005162","MGYS00005163","MGYS00005164","MGYS00005165","MGYS00005166","MGYS00005167","MGYS00005168","MGYS00005169","MGYS00005170","MGYS00005171","MGYS00005172","MGYS00005173","MGYS00005174","MGYS00005175","MGYS00005176","MGYS00005177","MGYS00005178","MGYS00005179","MGYS00005180","MGYS00005181","MGYS00005182","MGYS00005183","MGYS00005184","MGYS00005185","MGYS00005186","MGYS00005187","MGYS00005188","MGYS00005189","MGYS00005190","MGYS00005191","MGYS00005192","MGYS00005193","MGYS00005194","MGYS00005195","MGYS00005196","MGYS00005197","MGYS00005198","MGYS00005199","MGYS00005200","MGYS00005201","MGYS00005202","MGYS00005203","MGYS00005204","MGYS00005205","MGYS00005206","MGYS00005207","MGYS00005208","MGYS00005209","MGYS00005210","MGYS00005211","MGYS00005212","MGYS00005213","MGYS00005214","MGYS00005215","MGYS00005216","MGYS00005217","MGYS00005218","MGYS00005219","MGYS00005220","MGYS00005221","MGYS00005222","MGYS00005223","MGYS00005224","MGYS00005225","MGYS00005226","MGYS00005227","MGYS00005228","MGYS00005229","MGYS00005230","MGYS00005231","MGYS00005232","MGYS00005233","MGYS00005234","MGYS00005235","MGYS00005236","MGYS00005237","MGYS00005238","MGYS00005239","MGYS00005240","MGYS00005241","MGYS00005242","MGYS00005243","MGYS00005244","MGYS00005245","MGYS00005246","MGYS00005247","MGYS00005248","MGYS00005249","MGYS00005250","MGYS00005251","MGYS00005252","MGYS00005253","MGYS00005254","MGYS00005255","MGYS00005256","MGYS00005257","MGYS00005258","MGYS00005259","MGYS00005260","MGYS00005261","MGYS00005262","MGYS00005263","MGYS00005264","MGYS00005265","MGYS00005266","MGYS00005267","MGYS00005268","MGYS00005269","MGYS00005270","MGYS00005271","MGYS00005272","MGYS00005273","MGYS00005274","MGYS00005277","MGYS00005278","MGYS00005279","MGYS00005280","MGYS00005281","MGYS00005282","MGYS00005283","MGYS00005284","MGYS00005285","MGYS00005286","MGYS00005287","MGYS00005288","MGYS00005289","MGYS00005290","MGYS00005291","MGYS00005292","MGYS00005294","MGYS00005295","MGYS00005297","MGYS00005299","MGYS00005300","MGYS00005301","MGYS00005302","MGYS00005304","MGYS00005305","MGYS00005306","MGYS00005308","MGYS00005309","MGYS00005310","MGYS00005311","MGYS00005313","MGYS00005314","MGYS00005315","MGYS00005316","MGYS00005317","MGYS00005318","MGYS00005319","MGYS00005320","MGYS00005321","MGYS00005323","MGYS00005324","MGYS00005325","MGYS00005327","MGYS00005328","MGYS00005333","MGYS00005334","MGYS00005336","MGYS00005337","MGYS00005338","MGYS00005339","MGYS00005340","MGYS00005341","MGYS00005342","MGYS00005343","MGYS00005345","MGYS00005346","MGYS00005347","MGYS00005348","MGYS00005349","MGYS00005350","MGYS00005351","MGYS00005352","MGYS00005354","MGYS00005355","MGYS00005356","MGYS00005357","MGYS00005358","MGYS00005359","MGYS00005360","MGYS00005363","MGYS00005366","MGYS00005370","MGYS00005373","MGYS00005374","MGYS00005375","MGYS00005376","MGYS00005377","MGYS00005378","MGYS00005379","MGYS00005380","MGYS00005381","MGYS00005382","MGYS00005383","MGYS00005384","MGYS00005385","MGYS00005386","MGYS00005387","MGYS00005388","MGYS00005389","MGYS00005390","MGYS00005391","MGYS00005392","MGYS00005393","MGYS00005394","MGYS00005395","MGYS00005396","MGYS00005397","MGYS00005398","MGYS00005399","MGYS00005400","MGYS00005401","MGYS00005402","MGYS00005403","MGYS00005405","MGYS00005407","MGYS00005409","MGYS00005410","MGYS00005411","MGYS00005412","MGYS00005413","MGYS00005415","MGYS00005416","MGYS00005417","MGYS00005418","MGYS00005419","MGYS00005420","MGYS00005421","MGYS00005422","MGYS00005423","MGYS00005424","MGYS00005425","MGYS00005426","MGYS00005427","MGYS00005429","MGYS00005430","MGYS00005431","MGYS00005432","MGYS00005433","MGYS00005434","MGYS00005435","MGYS00005436","MGYS00005437","MGYS00005438","MGYS00005439","MGYS00005440","MGYS00005441","MGYS00005442","MGYS00005443","MGYS00005444","MGYS00005445","MGYS00005446","MGYS00005447","MGYS00005448","MGYS00005449","MGYS00005450","MGYS00005451","MGYS00005452","MGYS00005453","MGYS00005454","MGYS00005455","MGYS00005456","MGYS00005457","MGYS00005459","MGYS00005461","MGYS00005462","MGYS00005463","MGYS00005464","MGYS00005465","MGYS00005466","MGYS00005467","MGYS00005469","MGYS00005471","MGYS00005473","MGYS00005475","MGYS00005477","MGYS00005479","MGYS00005481","MGYS00005483","MGYS00005485","MGYS00005487","MGYS00005489","MGYS00005491","MGYS00005493","MGYS00005494","MGYS00005495","MGYS00005496","MGYS00005497","MGYS00005498","MGYS00005499","MGYS00005500","MGYS00005501","MGYS00005502","MGYS00005503","MGYS00005504","MGYS00005505","MGYS00005506","MGYS00005507","MGYS00005508","MGYS00005509","MGYS00005510","MGYS00005511","MGYS00005512","MGYS00005513","MGYS00005514","MGYS00005516","MGYS00005517","MGYS00005519","MGYS00005521","MGYS00005522","MGYS00005523","MGYS00005524","MGYS00005525","MGYS00005526","MGYS00005527","MGYS00005528","MGYS00005529","MGYS00005530","MGYS00005531","MGYS00005532","MGYS00005533","MGYS00005534","MGYS00005535","MGYS00005536","MGYS00005537","MGYS00005538","MGYS00005539","MGYS00005540","MGYS00005541","MGYS00005542","MGYS00005543","MGYS00005544","MGYS00005545","MGYS00005546","MGYS00005548","MGYS00005549","MGYS00005550","MGYS00005551","MGYS00005552","MGYS00005553","MGYS00005554","MGYS00005555","MGYS00005556","MGYS00005557","MGYS00005558","MGYS00005559","MGYS00005560","MGYS00005561","MGYS00005562","MGYS00005563","MGYS00005564","MGYS00005565","MGYS00005566","MGYS00005567","MGYS00005568","MGYS00005569","MGYS00005570","MGYS00005571","MGYS00005573","MGYS00005574","MGYS00005575","MGYS00005577","MGYS00005578","MGYS00005579","MGYS00005581","MGYS00005583","MGYS00005585","MGYS00005586","MGYS00005589","MGYS00005590","MGYS00005591","MGYS00005592","MGYS00005593","MGYS00005594","MGYS00005596","MGYS00005597","MGYS00005598","MGYS00005599","MGYS00005600","MGYS00005601","MGYS00005602","MGYS00005603","MGYS00005604","MGYS00005605","MGYS00005608","MGYS00005609","MGYS00005610","MGYS00005611","MGYS00005612","MGYS00005614","MGYS00005615","MGYS00005616","MGYS00005617","MGYS00005618","MGYS00005619","MGYS00005620","MGYS00005621","MGYS00005622","MGYS00005623","MGYS00005624","MGYS00005625","MGYS00005627","MGYS00005628","MGYS00005629","MGYS00005630","MGYS00005631","MGYS00005632","MGYS00005634","MGYS00005636","MGYS00005638","MGYS00005640","MGYS00005642","MGYS00005644","MGYS00005646","MGYS00005648","MGYS00005651","MGYS00005652","MGYS00005653","MGYS00005654","MGYS00005655","MGYS00005656","MGYS00005657","MGYS00005658","MGYS00005659","MGYS00005660","MGYS00005661","MGYS00005662","MGYS00005663","MGYS00005664","MGYS00005665","MGYS00005666","MGYS00005667","MGYS00005668","MGYS00005669","MGYS00005670","MGYS00005671","MGYS00005672","MGYS00005673","MGYS00005675","MGYS00005677","MGYS00005678","MGYS00005679","MGYS00005680","MGYS00005681","MGYS00005682","MGYS00005683","MGYS00005684","MGYS00005685","MGYS00005686","MGYS00005687","MGYS00005688","MGYS00005689","MGYS00005690","MGYS00005691","MGYS00005693","MGYS00005694","MGYS00005695","MGYS00005696","MGYS00005697","MGYS00005698","MGYS00005701","MGYS00005702","MGYS00005704","MGYS00005705","MGYS00005707","MGYS00005708"]

for k in range(len(biosample_list)):
    biosample = biosample_list[k]

def load_samples_json_file(biosample):
    with open(biosample + '/samples.json') as f:
        data = json.load(f)
    return data

def extract_relevant_fields_from_json(data, i):
    print(i)
    output_list = []
    output_list.append(data[i]['id']) #ERS4382422
    output_list.append(data[i]['attributes']['biosample']) #SAMEA6618691
    output_list.append(data[i]['attributes']['sample-metadata'])
    output_list.append(data[i]['attributes']['latitude'])
    output_list.append(data[i]['attributes']['accession']) #ERS4382422
    output_list.append(data[i]['attributes']['collection-date'])
    output_list.append(data[i]['attributes']['geo-loc-name'])
    output_list.append(data[i]['attributes']['sample-desc'])
    output_list.append(data[i]['attributes']['environment-biome'])
    output_list.append(data[i]['attributes']['environment-feature'])
    output_list.append(data[i]['attributes']['sample-name'])
    output_list.append(data[i]['attributes']['sample-alias'])
    output_list.append(data[i]['relationships']['runs']['links']['related'].split("/")[-2]) #SRS2788505
    output_list.append(data[i]['relationships']['biome']['data']['id']) #'root:Environmental:Aquatic:Marine'
    output_list.append(data[i]['relationships']['studies']['data'][0]['id']) #MGYS00005143
    return output_list

data = load_samples_json_file(biosample)

compiled_output_list = []

for i in range(len(data)):
    compiled_output_list.append(extract_relevant_fields_from_json(data, i))

i = 0

sample_run_id = data[i]['id'] #ERS4382422
biosample_id = data[i]['attributes']['biosample'] #SAMEA6618691
sample_metadata = data[i]['attributes']['sample-metadata'] #[{'key': 'collection date', 'value': '2019-04-14', 'unit': None}, {'key': 'ENA checklist', 'value': 'ERC000011', 'unit': None}]
longitude = data[i]['attributes']['longitude']
latitude = data[i]['attributes']['latitude']
accession = data[i]['attributes']['accession'] #ERS4382422
collection_data = data[i]['attributes']['collection-date']
geo_loc_name = data[i]['attributes']['geo-loc-name']
sample_desc = data[i]['attributes']['sample-desc']
environment_biome = data[i]['attributes']['environment-biome']
environment_feature = data[i]['attributes']['environment-feature']
sample_name = data[i]['attributes']['sample-name']
sample_alias = data[i]['attributes']['sample-alias']
runs = data[i]['relationships']['runs']['links']['related'].split("/")[-2] #SRS2788505
biome_id = data[i]['relationships']['biome']['data']['id'] #'root:Environmental:Aquatic:Marine'
studies = data[i]['relationships']['studies']['data'][0]['id'] #MGYS00005143
